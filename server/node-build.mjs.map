{"version":3,"file":"node-build.mjs","sources":["../../server/routes/demo.ts","../../server/routes/contact.ts","../../server/routes/bookings.ts","../../server/index.ts","../../server/node-build.ts"],"sourcesContent":["import { RequestHandler } from \"express\";\nimport { DemoResponse } from \"@shared/api\";\n\nexport const handleDemo: RequestHandler = (req, res) => {\n  const response: DemoResponse = {\n    message: \"Hello from Express server\",\n  };\n  res.status(200).json(response);\n};\n","import { RequestHandler } from \"express\";\nimport { z } from \"zod\";\n\n// Contact form validation schema\nconst ContactFormSchema = z.object({\n  name: z.string().min(2, \"Name must be at least 2 characters\"),\n  email: z.string().email(\"Invalid email address\"),\n  phone: z.string().min(10, \"Phone number must be at least 10 digits\"),\n  service: z.string().min(1, \"Service selection is required\"),\n  message: z.string().min(10, \"Message must be at least 10 characters\"),\n  urgency: z.enum([\"urgent\", \"normal\", \"low\"]).default(\"normal\"),\n});\n\n// In-memory storage for demo (replace with MongoDB later)\nconst contactSubmissions: Array<{\n  id: string;\n  timestamp: Date;\n  data: z.infer<typeof ContactFormSchema>;\n  status: 'new' | 'contacted' | 'completed';\n}> = [];\n\nexport const handleContactSubmission: RequestHandler = async (req, res) => {\n  try {\n    // Validate the request body\n    const validatedData = ContactFormSchema.parse(req.body);\n    \n    // Create a new submission\n    const submission = {\n      id: Date.now().toString(),\n      timestamp: new Date(),\n      data: validatedData,\n      status: 'new' as const\n    };\n    \n    // Store the submission (in production, this would go to MongoDB)\n    contactSubmissions.push(submission);\n    \n    console.log('New contact form submission:', submission);\n    \n    res.status(200).json({\n      success: true,\n      message: \"Form submitted successfully\",\n      submissionId: submission.id\n    });\n    \n  } catch (error) {\n    console.error('Error processing contact form:', error);\n    \n    if (error instanceof z.ZodError) {\n      res.status(400).json({\n        success: false,\n        message: \"Validation error\",\n        errors: error.errors\n      });\n    } else {\n      res.status(500).json({\n        success: false,\n        message: \"Internal server error\"\n      });\n    }\n  }\n};\n\nexport const getContactSubmissions: RequestHandler = (req, res) => {\n  // This will be used by the admin dashboard\n  const sortedSubmissions = contactSubmissions.sort((a, b) => \n    new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime()\n  );\n  \n  res.json({\n    success: true,\n    submissions: sortedSubmissions,\n    total: sortedSubmissions.length\n  });\n};\n\nexport const updateSubmissionStatus: RequestHandler = (req, res) => {\n  const { id } = req.params;\n  const { status } = req.body;\n  \n  const submission = contactSubmissions.find(s => s.id === id);\n  if (!submission) {\n    return res.status(404).json({\n      success: false,\n      message: \"Submission not found\"\n    });\n  }\n  \n  submission.status = status;\n  \n  res.json({\n    success: true,\n    message: \"Status updated successfully\",\n    submission\n  });\n};\n","import { RequestHandler } from \"express\";\nimport { z } from \"zod\";\n\n// Booking form validation schema\nconst BookingSchema = z.object({\n  name: z.string().min(2, \"Name must be at least 2 characters\"),\n  email: z.string().email(\"Invalid email address\"),\n  phone: z.string().min(10, \"Phone number must be at least 10 digits\"),\n  service: z.string().min(1, \"Service selection is required\"),\n  consultationType: z.enum([\"phone\", \"video\", \"inperson\"]),\n  preferredDate: z.string().min(1, \"Date is required\"),\n  preferredTime: z.string().min(1, \"Time is required\"),\n  budget: z.string().optional(),\n  description: z.string().optional(),\n  urgency: z.enum([\"urgent\", \"normal\", \"flexible\"]).default(\"normal\"),\n  agreeToTerms: z.boolean().refine(val => val === true, \"Must agree to terms\")\n});\n\n// In-memory storage for demo (replace with MongoDB later)\nconst bookings: Array<{\n  id: string;\n  timestamp: Date;\n  data: z.infer<typeof BookingSchema>;\n  status: 'pending' | 'confirmed' | 'completed' | 'cancelled';\n}> = [];\n\nexport const handleBookingSubmission: RequestHandler = async (req, res) => {\n  try {\n    // Validate the request body\n    const validatedData = BookingSchema.parse(req.body);\n    \n    // Create a new booking\n    const booking = {\n      id: `BK${Date.now()}`,\n      timestamp: new Date(),\n      data: validatedData,\n      status: 'pending' as const\n    };\n    \n    // Store the booking (in production, this would go to MongoDB)\n    bookings.push(booking);\n    \n    console.log('New consultation booking:', booking);\n    \n    res.status(200).json({\n      success: true,\n      message: \"Booking submitted successfully\",\n      bookingId: booking.id,\n      booking: booking\n    });\n    \n  } catch (error) {\n    console.error('Error processing booking:', error);\n    \n    if (error instanceof z.ZodError) {\n      res.status(400).json({\n        success: false,\n        message: \"Validation error\",\n        errors: error.errors\n      });\n    } else {\n      res.status(500).json({\n        success: false,\n        message: \"Internal server error\"\n      });\n    }\n  }\n};\n\nexport const getBookings: RequestHandler = (req, res) => {\n  // This will be used by the admin dashboard\n  const sortedBookings = bookings.sort((a, b) => \n    new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime()\n  );\n  \n  res.json({\n    success: true,\n    bookings: sortedBookings,\n    total: sortedBookings.length\n  });\n};\n\nexport const updateBookingStatus: RequestHandler = (req, res) => {\n  const { id } = req.params;\n  const { status } = req.body;\n  \n  const booking = bookings.find(b => b.id === id);\n  if (!booking) {\n    return res.status(404).json({\n      success: false,\n      message: \"Booking not found\"\n    });\n  }\n  \n  booking.status = status;\n  \n  res.json({\n    success: true,\n    message: \"Booking status updated successfully\",\n    booking\n  });\n};\n\nexport const getBookingById: RequestHandler = (req, res) => {\n  const { id } = req.params;\n  \n  const booking = bookings.find(b => b.id === id);\n  if (!booking) {\n    return res.status(404).json({\n      success: false,\n      message: \"Booking not found\"\n    });\n  }\n  \n  res.json({\n    success: true,\n    booking\n  });\n};\n","import express from \"express\";\nimport cors from \"cors\";\nimport { handleDemo } from \"./routes/demo\";\nimport { handleContactSubmission, getContactSubmissions, updateSubmissionStatus } from \"./routes/contact\";\nimport { handleBookingSubmission, getBookings, updateBookingStatus, getBookingById } from \"./routes/bookings\";\n\nexport function createServer() {\n  const app = express();\n\n  // Middleware\n  app.use(cors());\n  app.use(express.json());\n  app.use(express.urlencoded({ extended: true }));\n\n  // Example API routes\n  app.get(\"/api/ping\", (_req, res) => {\n    res.json({ message: \"Hello from Express server v2!\" });\n  });\n\n  app.get(\"/api/demo\", handleDemo);\n  \n  // Contact form routes\n  app.post(\"/api/contact\", handleContactSubmission);\n  app.get(\"/api/contact/submissions\", getContactSubmissions);\n  app.put(\"/api/contact/submissions/:id\", updateSubmissionStatus);\n\n  // Booking routes\n  app.post(\"/api/bookings\", handleBookingSubmission);\n  app.get(\"/api/bookings\", getBookings);\n  app.get(\"/api/bookings/:id\", getBookingById);\n  app.put(\"/api/bookings/:id\", updateBookingStatus);\n\n  return app;\n}\n","import path from \"path\";\nimport { createServer } from \"./index\";\nimport * as express from \"express\";\n\nconst app = createServer();\nconst port = process.env.PORT || 3000;\n\n// In production, serve the built SPA files\nconst __dirname = import.meta.dirname;\nconst distPath = path.join(__dirname, \"../spa\");\n\n// Serve static files\napp.use(express.static(distPath));\n\n// Handle React Router - serve index.html for all non-API routes\napp.get(\"*\", (req, res) => {\n  // Don't serve index.html for API routes\n  if (req.path.startsWith(\"/api/\") || req.path.startsWith(\"/health\")) {\n    return res.status(404).json({ error: \"API endpoint not found\" });\n  }\n\n  res.sendFile(path.join(distPath, \"index.html\"));\n});\n\napp.listen(port, () => {\n  console.log(`ðŸš€ Fusion Starter server running on port ${port}`);\n  console.log(`ðŸ“± Frontend: http://localhost:${port}`);\n  console.log(`ðŸ”§ API: http://localhost:${port}/api`);\n});\n\n// Graceful shutdown\nprocess.on(\"SIGTERM\", () => {\n  console.log(\"ðŸ›‘ Received SIGTERM, shutting down gracefully\");\n  process.exit(0);\n});\n\nprocess.on(\"SIGINT\", () => {\n  console.log(\"ðŸ›‘ Received SIGINT, shutting down gracefully\");\n  process.exit(0);\n});\n"],"names":["app","express"],"mappings":"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"}